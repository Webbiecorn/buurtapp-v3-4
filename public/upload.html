<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Uploader</title>
    <style>
        body { font-family: sans-serif; background-color: #f3f4f6; display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 1rem; }
        .container { background-color: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; width: 100%; max-width: 600px; }
        button { background-color: #1e40af; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; font-size: 1rem; cursor: pointer; transition: background-color 0.2s; }
        button:disabled { background-color: #9ca3af; cursor: not-allowed; }
        pre { background-color: #111827; color: #d1d5db; padding: 1rem; border-radius: 0.5rem; text-align: left; max-height: 300px; overflow-y: auto; margin-top: 1.5rem; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>

    <div class="container">
        <h1 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">Firestore Data Uploader</h1>
        <p style="margin-bottom: 1.5rem;">Klik op de knop om de testdata naar je database te uploaden. De voortgang verschijnt hieronder.</p>
        <button id="uploadButton">Start Upload</button>
        <pre id="log"></pre>
    </div>

    <script type="module">
        // Importeer de Firebase functies direct van de CDN
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getFirestore, collection, addDoc, Timestamp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

        // -------------------------------------------------------------------
        // TODO: Plak hieronder jouw EIGEN Firebase configuratie sleutels
        // -------------------------------------------------------------------
        const firebaseConfig = {
  apiKey: "AIzaSyDdNt987MgEFsi2AUsYTV-kyvXK_y9gmIs",
  authDomain: "buurtapp-v3-4.firebaseapp.com",
  projectId: "buurtapp-v3-4",
  storageBucket: "buurtapp-v3-4.firebasestorage.app",
  messagingSenderId: "740445217879",
  appId: "1:740445217879:web:afa1154ca0c5894a29af12"
};
        // -------------------------------------------------------------------

        // Initialiseer Firebase en Firestore
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- TESTDATA DIRECT IN HET SCRIPT GEPLAKT ---
        const MOCK_USERS = [
          { id: 'user-1', name: 'Admin Ali', email: 'ali@buurt.app', role: 'Beheerder', avatarUrl: 'https://i.pravatar.cc/150?u=user-1', phone: '0610000001' },
          { id: 'user-2', name: 'Conciërge Carla', email: 'carla@buurt.app', role: 'Concierge', avatarUrl: 'https://i.pravatar.cc/150?u=user-2', phone: '0610000002' },
          { id: 'user-3', name: 'Conciërge Chris', email: 'chris@buurt.app', role: 'Concierge', avatarUrl: 'https://i.pravatar.cc/150?u=user-3', phone: '0610000003' },
          { id: 'user-4', name: 'Viewer Vera', email: 'vera@buurt.app', role: 'Viewer', avatarUrl: 'https://i.pravatar.cc/150?u=user-4', phone: '0610000004' },
        ];

        const MOCK_MELDINGEN = [
          { titel: 'Kapotte straatlantaarn', omschrijving: 'Lantaarnpaal #334 is defect.', status: 'In behandeling', attachments: ['https://picsum.photos/seed/melding1/800/600'], locatie: { lat: 52.0938, lon: 5.1083 }, timestamp: new Date(), gebruikerId: 'user-2', wijk: 'Lombok', categorie: 'Straatmeubilair', updates: [] },
          { titel: 'Overvolle afvalcontainer', omschrijving: 'Container bij supermarkt is vol.', status: 'Fixi melding gemaakt', attachments: ['https://picsum.photos/seed/melding2/800/600'], locatie: { lat: 52.0908, lon: 5.1063 }, timestamp: new Date(), gebruikerId: 'user-3', wijk: 'Lombok', categorie: 'Afval', updates: [] },
        ];

        const MOCK_PROJECTEN = [
          { title: 'Buurttuin "De Groene Vingers"', description: 'Samen een buurttuin maken.', creatorId: 'user-1', participantIds: ['user-1', 'user-2'], status: 'Lopend', startDate: new Date(), attachments: [], imageUrl: 'https://picsum.photos/seed/project1/800/400', contributions: [] },
          { title: 'Opknapbeurt Speeltuin', description: 'De speeltuin opknappen.', creatorId: 'user-1', participantIds: ['user-1'], status: 'Lopend', startDate: new Date(), attachments: [], imageUrl: 'https://picsum.photos/seed/project2/800/400', contributions: [] },
        ];


        // --- De rest van het script blijft hetzelfde ---
        const uploadButton = document.getElementById('uploadButton');
        const logElement = document.getElementById('log');

        function log(message) {
            console.log(message);
            logElement.textContent += message + '\n';
            logElement.scrollTop = logElement.scrollHeight;
        }

        async function uploadCollection(collectionName, dataArray, nameField) {
            log(`--- Starten met uploaden: ${collectionName} ---`);
            const collectionRef = collection(db, collectionName);
            for (const item of dataArray) {
                const firestoreItem = { ...item };
                delete firestoreItem.id; // Verwijder het mock-ID, Firestore genereert een eigen ID
                for (const key in firestoreItem) {
                    if (firestoreItem[key] instanceof Date) {
                        firestoreItem[key] = Timestamp.fromDate(firestoreItem[key]);
                    }
                }
                await addDoc(collectionRef, firestoreItem);
                log(`  Toegevoegd: ${item[nameField]}`);
            }
            log(`--- Collectie ${collectionName} voltooid ---\n`);
        }

        uploadButton.addEventListener('click', async () => {
            uploadButton.disabled = true;
            uploadButton.textContent = 'Bezig...';
            log('Starten met het uploaden van de testdata...');

            try {
                await uploadCollection('users', MOCK_USERS, 'name');
                await uploadCollection('meldingen', MOCK_MELDINGEN, 'titel');
                await uploadCollection('projecten', MOCK_PROJECTEN, 'title');
                log('✅ ALLES VOLTOOID! De database is gevuld.');
                log('Je kunt nu door naar de laatste fase: de app publiceren.');
                uploadButton.textContent = 'Klaar!';
            } catch (error) {
                log(`❌ FOUT: ${error.message}`);
                console.error(error);
                uploadButton.textContent = 'Fout opgetreden';
            }
        });
    </script>

</body>
</html>
